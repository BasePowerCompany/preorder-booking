!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function o(){return Object.create(null)}function s(e){e.forEach(n)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let c,l;function a(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function d(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode&&e.parentNode.removeChild(e)}function f(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function g(){return m(" ")}function h(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function y(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function v(e,t){t=""+t,e.data!==t&&(e.data=t)}function b(e,t,n){e.classList[n?"add":"remove"](t)}function _(e){l=e}function $(){if(!l)throw new Error("Function called outside component initialization");return l}function w(e){$().$$.on_mount.push(e)}function S(){const e=$();return(t,n,{cancelable:o=!1}={})=>{const s=e.$$.callbacks[t];if(s){const r=function(e,t,{bubbles:n=!1,cancelable:o=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,o,t),s}(t,n,{cancelable:o});return s.slice().forEach((t=>{t.call(e,r)})),!r.defaultPrevented}return!0}}const A=[],E=[];let x=[];const C=[],k=Promise.resolve();let z=!1;function L(e){x.push(e)}const j=new Set;let T=0;function q(){if(0!==T)return;const e=l;do{try{for(;T<A.length;){const e=A[T];T++,_(e),P(e.$$)}}catch(e){throw A.length=0,T=0,e}for(_(null),A.length=0,T=0;E.length;)E.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];j.has(t)||(j.add(t),t())}x.length=0}while(A.length);for(;C.length;)C.pop()();z=!1,j.clear(),_(e)}function P(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(L)}}const B=new Set;function K(e,t){e&&e.i&&(B.delete(e),e.i(t))}function O(e,t,o,i){const{fragment:c,after_update:l}=e.$$;c&&c.m(t,o),i||L((()=>{const t=e.$$.on_mount.map(n).filter(r);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),l.forEach(L)}function I(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];x.forEach((o=>-1===e.indexOf(o)?t.push(o):n.push(o))),n.forEach((e=>e())),x=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function N(e,t){-1===e.$$.dirty[0]&&(A.push(e),z||(z=!0,k.then(q)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Q(t,n,r,i,c,a,d,u=[-1]){const f=l;_(t);const m=t.$$={fragment:null,ctx:[],props:a,update:e,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};d&&d(m.root);let g=!1;if(m.ctx=r?r(t,n.props||{},((e,n,...o)=>{const s=o.length?o[0]:n;return m.ctx&&c(m.ctx[e],m.ctx[e]=s)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](s),g&&N(t,e)),n})):[],m.update(),g=!0,s(m.before_update),m.fragment=!!i&&i(m.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);m.fragment&&m.fragment.l(e),e.forEach(p)}else m.fragment&&m.fragment.c();n.intro&&K(t.$$.fragment),O(t,n.target,n.anchor,n.customElement),q()}_(f)}class D{$destroy(){I(this,1),this.$destroy=e}$on(t,n){if(!r(n))return e;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const e=o.indexOf(n);-1!==e&&o.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}let U=!1;const F=[];function M(e,t){if(window.google&&window.google.maps&&window.google.maps.places)return void t();if(t&&F.push(t),U)return;U=!0;const n=document.createElement("script");n.async=!0,n.defer=!0,n.onload=R,n.src=`https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(e)}&libraries=places`,n.type="text/javascript",document.head.appendChild(n)}function R(){let e;for(U=!1;e=F.pop();)e()}function V(t){let n,o,r,i;return{c(){n=f("input"),y(n,"class",o=t[7].class),y(n,"placeholder",t[0]),n.value=t[1],n.required=t[2],y(n,"pattern",t[3]),b(n,"input",!0)},m(e,o){u(e,n,o),t[11](n),r||(i=[h(n,"change",t[5]),h(n,"keydown",t[6])],r=!0)},p(e,[t]){128&t&&o!==(o=e[7].class)&&y(n,"class",o),1&t&&y(n,"placeholder",e[0]),2&t&&n.value!==e[1]&&(n.value=e[1]),4&t&&(n.required=e[2]),8&t&&y(n,"pattern",e[3]),128&t&&b(n,"input",!0)},i:e,o:e,d(e){e&&p(n),t[11](null),r=!1,s(i)}}}function Z(e,n,o){let s,{apiKey:r}=n,{options:i}=n,{placeholder:c}=n,{value:l=""}=n,{required:d=!1}=n,{pattern:u=""}=n,{onSelect:p}=n;const f=S();let m;function g(){o(4,m.value="",m),h()}function h(){""===m.value&&y(null)}function y(e){s=e&&e.text||"",f("place_changed",e)}return w((()=>{M(r,(()=>{o(8,i.types=["street_address","premise","subpremise","point_of_interest"],i);const e=new google.maps.places.Autocomplete(m,Object.assign({},i));e.addListener("place_changed",(()=>{const t=e.getPlace();(function(e){const t=i&&i.fields||["geometry"];return e.hasOwnProperty(t[0])})(t)&&(p(t),y({place:t,text:m.value}))})),f("ready"),setTimeout((()=>{m.setAttribute("autocomplete","one-time-code")}),2e3)}))})),e.$$set=e=>{o(7,n=t(t({},n),a(e))),"apiKey"in e&&o(9,r=e.apiKey),"options"in e&&o(8,i=e.options),"placeholder"in e&&o(0,c=e.placeholder),"value"in e&&o(1,l=e.value),"required"in e&&o(2,d=e.required),"pattern"in e&&o(3,u=e.pattern),"onSelect"in e&&o(10,p=e.onSelect)},e.$$.update=()=>{2&e.$$.dirty&&(s=l||"")},n=a(n),[c,l,d,u,m,h,function(e){const t=document.getElementsByClassName("pac-item").length;if("Enter"===e.key||"Tab"===e.key)if(t){document.getElementsByClassName("pac-item-selected").length||function(){const e=new KeyboardEvent("keydown",{key:"ArrowDown",code:"ArrowDown",keyCode:40});m.dispatchEvent(e)}()}else(function(e){return s!==e})(m.value)&&setTimeout(g,10);else"Escape"===e.key&&setTimeout(g,10);t&&"Enter"===e.key&&e.preventDefault()},n,i,r,p,function(e){E[e?"unshift":"push"]((()=>{m=e,o(4,m)}))}]}class H extends D{constructor(e){super(),Q(this,e,Z,V,i,{apiKey:9,options:8,placeholder:0,value:1,required:2,pattern:3,onSelect:10})}}const G=(J="addressState",{update:e=>{try{window[J]=Object.assign(Object.assign({},window[J]),e)}catch(e){}},get:()=>{try{return window[J]}catch(e){return{}}}});var J;function W(e){let t,n;return{c(){t=f("p"),n=m(e[4]),y(t,"class","preorder-address-error-message")},m(e,o){u(e,t,o),d(t,n)},p(e,t){16&t&&v(n,e[4])},d(e){e&&p(t)}}}function X(e){let t,n,o,s,r,i,l,a,b,_,$,w,S,A,E;i=new H({props:{class:"location-search-input",apiKey:e[0],placeholder:"Enter home address",onSelect:e[8],options:{componentRestrictions:{country:"us"},types:["address"],fields:["address_components","formatted_address","name","place_id","url"]}}});let x=e[4]&&W(e);return{c(){var d,u,p;t=f("div"),n=f("div"),o=f("img"),r=g(),(d=i.$$.fragment)&&d.c(),l=g(),a=f("button"),b=m(e[1]),_=g(),x&&x.c(),$=g(),w=f("div"),u=o.src,p=s="https://cdn.jsdelivr.net/gh/BasePowerCompany/preorder-booking@1.0.1/public/Base_files/map-pin.svg",c||(c=document.createElement("a")),c.href=p,u!==c.href&&y(o,"src","https://cdn.jsdelivr.net/gh/BasePowerCompany/preorder-booking@1.0.1/public/Base_files/map-pin.svg"),y(o,"alt","Map pin icon"),y(n,"class","input-address-container"),y(a,"class","submitAddressButton button secondary w-button"),y(t,"class","input-address-wrap"),y(w,"class","focus_overlay")},m(s,c){u(s,t,c),d(t,n),d(n,o),d(n,r),O(i,n,null),d(t,l),d(t,a),d(a,b),d(t,_),x&&x.m(t,null),u(s,$,c),u(s,w,c),S=!0,A||(E=h(a,"click",e[5]),A=!0)},p(e,[n]){const o={};1&n&&(o.apiKey=e[0]),28&n&&(o.onSelect=e[8]),i.$set(o),(!S||2&n)&&v(b,e[1]),e[4]?x?x.p(e,n):(x=W(e),x.c(),x.m(t,null)):x&&(x.d(1),x=null)},i(e){S||(K(i.$$.fragment,e),S=!0)},o(e){!function(e,t,n,o){if(e&&e.o){if(B.has(e))return;B.add(e),(void 0).c.push((()=>{B.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}else o&&o()}(i.$$.fragment,e),S=!1},d(e){e&&p(t),I(i),x&&x.d(),e&&p($),e&&p(w),A=!1,E()}}}function Y(e,t,n){let o,{targetDisplayAddress:s}=t,{googlePublicApiKey:r}=t,{addressCtaText:i="See if my home qualifies"}=t,{onAddressSelect:c}=t,{onAddressSubmitSuccess:l}=t;S();let a=null;function d(){if(!a)return;if(!a.postalCode||!a.houseNumber||!a.street)return;const e=document.querySelector(s);e&&(e.innerHTML=a.formattedAddress),G.update({selectedAddress:a}),null==l||l(a)}w((()=>{jQuery(".input-address-container").on("click",(function(){jQuery(".focus_overlay").show(),jQuery(".input-address-container").addClass("focused"),jQuery("input.location-search-input").attr("placeholder","Enter home address"),jQuery("button.submitAddressButton").hide()})),jQuery(".input-address-container").on("keydown",(function(){jQuery("input.location-search-input").attr("placeholder","")})),jQuery(".focus_overlay").on("click",(function(){jQuery(".focus_overlay").hide(),jQuery(".submitAddressButton").show(),jQuery(".input-address-container").removeClass("focused")}))}));return e.$$set=e=>{"targetDisplayAddress"in e&&n(6,s=e.targetDisplayAddress),"googlePublicApiKey"in e&&n(0,r=e.googlePublicApiKey),"addressCtaText"in e&&n(1,i=e.addressCtaText),"onAddressSelect"in e&&n(2,c=e.onAddressSelect),"onAddressSubmitSuccess"in e&&n(7,l=e.onAddressSubmitSuccess)},n(4,o=""),n(3,a=null),[r,i,c,a,o,d,s,l,e=>{const t=(e=>{console.log("Parsing place result:",e);const t=(e.address_components||[]).reduce((function(e,t){return t.types.forEach((function(n){e[n]=t})),e}),{});console.log("Address components by type:",t);const n=(e,n=!1)=>e in t?n?t[e].short_name:t[e].long_name:(console.log(`Missing address component: ${e}`),null),o=n("street_number")||n("subpremise")||n("premise"),s=n("route")||n("street_address")||n("premise"),r=n("postal_code")||n("postal_code_prefix"),i={title:e.name,formattedAddress:e.formatted_address,externalId:e.place_id,externalUrl:e.url,houseNumber:o,street:s,street_2:[n("floor"),n("subpremise")].filter((e=>!!e)).join(",")||null,city:n("locality")||n("sublocality")||n("sublocality_level_1")||n("neighborhood")||n("administrative_area_level_3")||n("administrative_area_level_2"),county:n("administrative_area_level_2"),stateShort:n("administrative_area_level_1",!0),stateLong:n("administrative_area_level_1"),countryCode:n("country",!0),countryLong:n("country"),postalCode:r};return console.log("Parsed result:",i),i})(e);c?.(t),window.blur(),n(4,o=""),n(3,a=t),d()}]}class ee extends D{constructor(e){super(),Q(this,e,Y,X,i,{targetDisplayAddress:6,googlePublicApiKey:0,addressCtaText:1,onAddressSelect:2,onAddressSubmitSuccess:7})}}function te(t){let n,o,r,i,c,l,a,_,$,w,S,A,E,x,C,k,z,L,j,T,q,P,B,K,O,I,N,Q=(t[1][0]||"")+"",D=(t[1][1]||"")+"",U=(t[1][2]||"")+"",F=(t[1][3]||"")+"",M=(t[1][4]||"")+"",R=(t[6]?t[0]:"Enter your zip code")+"";return{c(){n=f("div"),o=f("div"),r=f("input"),i=g(),c=f("div"),l=f("div"),a=m(Q),_=g(),$=f("div"),w=m(D),S=g(),A=f("div"),E=m(U),x=g(),C=f("div"),k=m(F),z=g(),L=f("div"),j=m(M),T=g(),q=f("button"),P=m(R),K=g(),O=f("div"),y(r,"type","text"),y(r,"inputmode","numeric"),y(r,"pattern","[0-9]*"),y(r,"class","zip-search-input"),y(r,"maxlength","5"),y(l,"class","zip-box"),b(l,"filled",t[1].length>=1),b(l,"blinking-cursor",t[5]&&0===t[1].length),y($,"class","zip-box"),b($,"filled",t[1].length>=2),y(A,"class","zip-box"),b(A,"filled",t[1].length>=3),y(C,"class","zip-box"),b(C,"filled",t[1].length>=4),y(L,"class","zip-box"),b(L,"filled",t[1].length>=5),y(c,"class","zip-boxes"),y(o,"class","input-zip-container"),y(q,"class","submitZipButton button secondary w-button"),q.disabled=B=!t[6],y(n,"class","input-zip-wrap"),y(O,"class","focus_overlay")},m(e,s){u(e,n,s),d(n,o),d(o,r),t[10](r),d(o,i),d(o,c),d(c,l),d(l,a),d(c,_),d(c,$),d($,w),d(c,S),d(c,A),d(A,E),d(c,x),d(c,C),d(C,k),d(c,z),d(c,L),d(L,j),t[12](o),d(n,T),d(n,q),d(q,P),u(e,K,s),u(e,O,s),t[13](O),I||(N=[h(r,"input",t[7]),h(r,"keydown",t[11]),h(q,"click",t[8])],I=!0)},p(e,[t]){2&t&&Q!==(Q=(e[1][0]||"")+"")&&v(a,Q),2&t&&b(l,"filled",e[1].length>=1),34&t&&b(l,"blinking-cursor",e[5]&&0===e[1].length),2&t&&D!==(D=(e[1][1]||"")+"")&&v(w,D),2&t&&b($,"filled",e[1].length>=2),2&t&&U!==(U=(e[1][2]||"")+"")&&v(E,U),2&t&&b(A,"filled",e[1].length>=3),2&t&&F!==(F=(e[1][3]||"")+"")&&v(k,F),2&t&&b(C,"filled",e[1].length>=4),2&t&&M!==(M=(e[1][4]||"")+"")&&v(j,M),2&t&&b(L,"filled",e[1].length>=5),65&t&&R!==(R=(e[6]?e[0]:"Enter your zip code")+"")&&v(P,R),64&t&&B!==(B=!e[6])&&(q.disabled=B)},i:e,o:e,d(e){e&&p(n),t[10](null),t[12](null),e&&p(K),e&&p(O),t[13](null),I=!1,s(N)}}}function ne(e,t,n){let o,s,r,i,{addressCtaText:c="See if I qualify"}=t,{onAddressSubmitSuccess:l=()=>{}}=t,a=!1;const d=()=>{if(s.classList.add("focused"),null==i||i.focus(),i){const e=i.value.length;i.setSelectionRange(e,e)}};var u;w((()=>{s&&r&&i&&(s.addEventListener("click",d),i.addEventListener("focus",(()=>{n(3,r.style.display="block",r),s.classList.add("focused"),n(5,a=!0)})),i.addEventListener("blur",(()=>{n(3,r.style.display="none",r),s.classList.remove("focused"),n(5,a=!1)})))})),u=()=>{s&&r&&i&&(s.removeEventListener("click",d),i.removeEventListener("focus",(()=>{})),i.removeEventListener("blur",(()=>{})))},$().$$.on_destroy.push(u);let p="";const f=()=>{if(!p)return;if(5!==p.length)return;const e={title:"",formattedAddress:"",externalId:"",externalUrl:"",houseNumber:"",street:"",street_2:"",city:"",county:"",stateShort:"",stateLong:"",countryCode:"US",countryLong:"United States",postalCode:p};G.update({selectedAddress:e}),"function"==typeof l?l(e):console.error("onAddressSubmitSuccess is not a function:",l)};return e.$$set=e=>{"addressCtaText"in e&&n(0,c=e.addressCtaText),"onAddressSubmitSuccess"in e&&n(9,l=e.onAddressSubmitSuccess)},e.$$.update=()=>{2&e.$$.dirty&&n(6,o=5===p.length)},[c,p,s,r,i,a,o,e=>{const t=e.target,o=t.value.replace(/\D/g,"");o.length>5?t.value=o.slice(0,5):t.value=o,n(1,p=t.value)},f,l,function(e){E[e?"unshift":"push"]((()=>{i=e,n(4,i)}))},e=>{"Enter"===e.key&&o&&f()},function(e){E[e?"unshift":"push"]((()=>{s=e,n(2,s)}))},function(e){E[e?"unshift":"push"]((()=>{r=e,n(3,r)}))}]}class oe extends D{constructor(e){super(),Q(this,e,ne,te,i,{addressCtaText:0,onAddressSubmitSuccess:9})}}let se=null;const re={initialize:e=>{const{targetElAddressInput:t=document.getElementById("hero-address-entry"),googlePublicApiKey:n,onAddressSelect:o,onAddressSubmitSuccess:s,addressCtaText:r,querySelectorClickToOpenForm:i}=e,c=new ee({target:t,props:{googlePublicApiKey:n,onAddressSelect:o,onAddressSubmitSuccess:s,addressCtaText:"See if my home qualifies",targetDisplayAddress:"#hero-address-entry"}});if(i&&t){document.querySelectorAll(i).forEach((e=>{e.addEventListener("click",(()=>{t.scrollIntoView({behavior:"smooth",block:"center"});const e=t.querySelector(".input-address-container");e&&e.dispatchEvent(new MouseEvent("click",{bubbles:!0}));const n=t.querySelector("input");n&&n.focus()}))}))}return c},initializeZipCode:e=>{se&&(se.$destroy(),se=null);const{targetElAddressInput:t=document.getElementById("zip-code-entry"),onAddressSubmitSuccess:n,addressCtaText:o,querySelectorClickToOpenForm:s}=e,r=new oe({target:t,props:{onAddressSubmitSuccess:async e=>{var t,o;try{const s="localhost"===window.location.hostname?"/deregulated-zips.csv":"https://bpc-web-static-files.s3.us-east-2.amazonaws.com/deregulated-zips.csv";console.log("Fetching CSV from:",s);const r=await fetch(s);if(!r.ok)throw new Error("Failed to fetch CSV");const i=(await r.text()).split("\n"),c=null===(o=null===(t=null==e?void 0:e.postalCode)||void 0===t?void 0:t.trim())||void 0===o?void 0:o.substring(0,5);console.log("Submitted zip code:",c);let l="no",a=!1;i.slice(1).some((e=>{var t,n;const o=e.split(","),s=null===(t=o[1])||void 0===t?void 0:t.trim(),r=null===(n=o[4])||void 0===n?void 0:n.trim();if(console.log(`Checking zip ${s} against ${c}, serving_now: ${r}`),s===c){if(a=!0,console.log("Found zip in CSV:",o),"yes"===r||"houston"===r)return l="yes",!0;if("preorder"===r)return l="preorder",!0}return!1})),console.log("Market status:",l,"Found:",a),"function"==typeof n&&n(e,void 0,{servingNow:l})}catch(t){console.error("Error checking zip code:",t),"function"==typeof n&&n(e,void 0,{servingNow:"no"})}},addressCtaText:o}});if(s&&t){document.querySelectorAll(s).forEach((e=>{e.addEventListener("click",(()=>{const e=t.querySelector("input");if(e){e.focus();const n=t.querySelector(".input-zip-container");n&&n.classList.add("focused")}}))}))}return se=r,r}};window.BasePreorderApp=re,document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("zip-code-entry")&&re.initializeZipCode({targetElAddressInput:document.getElementById("zip-code-entry"),querySelectorClickToOpenForm:'[data-preorder="open"]',addressCtaText:"Check availability",googleSheetConfig:{zipsCsvUrl:"https://bpc-web-static-files.s3.us-east-2.amazonaws.com/deregulated-zips.csv"},onAddressSubmitSuccess:async(e,t,n)=>{const o=(null==n?void 0:n.servingNow)||"no",s=new URL("yes"===o?"/available-now":"preorder"===o?"/available-soon":"/not-available",window.location.origin),r=new URLSearchParams(window.location.search),i={zip:(null==e?void 0:e.postalCode)||"",gclid:r.get("gclid"),utm_source:r.get("utm_source"),utm_medium:r.get("utm_medium"),utm_campaign:r.get("utm_campaign"),utm_term:r.get("utm_term"),utm_content:r.get("utm_content"),referrer_name:r.get("referrer_name")},c={};Object.entries(i).forEach((([e,t])=>{t&&(c[e]=t)})),s.search=new URLSearchParams(c).toString(),window.location.href=s.toString()}})}))}));
//# sourceMappingURL=embed.js.map
